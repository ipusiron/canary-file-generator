# Advanced: 実運用での欺瞞技術とセキュリティ戦略

> **注記**: 以下のAdvanced セクションは、本ツールの機能を超えた発展的な内容です。  
> 実際の運用環境での欺瞞技術の理論と実装について詳述しています。

## 1) 追加の有効性（研究・実務の観点）
- **行動成形（Behavior Shaping）**  
  攻撃者が「美味しそう」に見える経路・アカウント・ファイルへと自然に誘導し、**攻撃面をコントロール**する。  
  例：本番DBではなく"バックアップ風アーカイブ"に視線を向けさせる。
- **TTP/IOC 収集（観測装置）**  
  誘引ポイントで **手口・ツール・インフラ（TTP/IOC）** を採取し、検知ルールや脅威インテリジェンスを強化。
- **アトリビューション補助**  
  一意なトークン（カナリア語句、ユニークID）を仕込み、外部で再出現した際に**漏洩源や経路を特定**する助けにする。
- **コントロール妥当性の継続検証（Purple Team）**  
  罠に対するSOCの検知・通報・封じ込め手順を **常時・軽量に検証**（シンセティック・モニタリングの一種）。
- **内部不正・横移動の早期検出**  
  正規業務では触れないはずのデータ／アカウントへのアクセスで **誤用・越権・内部脅威** を可視化。
- **証拠性・追跡性の向上**  
  カナリア識別子をログやデータに散りばめ、**証拠保全・再現性** を高め、事後調査を短縮。

> まとめ：**誘引（餌）＋観測（センサー）＋成形（誘導）** の三位一体で "攻撃側の労力" と "防御側の学習" を最大化。

## 運用設計チェックリスト
- **Plausibility（もっともらしさ）**：命名・タイムスタンプ・権限・配置・拡張子・サイズ・圧縮形式の整合性。
- **Non‑Interference（非干渉）**：本番処理・可用性を壊さない。認証・権限系から切り離す。
- **Observability（観測性）**：`auditd/fanotify/EDR` 等で開封・コピー・転送を捕捉し、SIEMに連携。識別子を**ログとデータの両方**に。
- **Rotation & Hygiene**：デコイの更新・回収・再配置を定期運用。露見・誤検知・陳腐化にケア。
- **Deconfliction（衝突回避）**：レッドチーム・診断・バックアップ運用と事前調整。
- **Governance / Legal / Ethics**：ポリシー・個人情報・規制遵守。関係者最小限の知る必要原則。

## 実装パターン
- **Honeywords（パスワード候補群）**：正答に似た複数候補（ダミー）を混在させ、**誤用で即検知**。  
- **Breadcrumbs（誘導パンくず）**：低権限ホストに"運用メモ風"ファイル → 上位資産の**偽URL/鍵**へ誘導 → カナリア仕込み。  
- **Tarpit（足止め）**：SSH/SMTP 等で**遅延・再試行コスト**を増やす（可用性影響に注意）。

## 失敗パターン
- **あからさまな偽物**：命名・パス・権限・更新日が不自然で即見抜かれる。  
- **本番と混線**：本当にログインできてしまう／本番ジョブが誤参照。  
- **ログの孤立**：監査イベントがSIEMへ届かず、**検知しても動けない**。  
- **置きっぱなし**：時代錯誤の痕跡で逆にバレる。  
- **過度な収集**：ガバナンス・プライバシーに抵触。

## まとめ
- 誘引→検知／時間稼ぎに加え、**行動成形・観測・証拠性** を兼ねると効果が最大化。  
- `passwd`/`shadow` 風デコイは **本流から隔離**＋**強力ハッシュ**＋**監査**＋**識別子** の三点セットで。  
- 欺瞞の価値は **攻撃者の意思決定をこちらの土俵に乗せること** にある。